

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Run regression tests &mdash; Malaria Model  documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  

  
  
    
      <link rel="search" type="application/opensearchdescription+xml" title="Search within Malaria Model  documentation" href="_static/opensearch.xml"/>
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/tipuesearch/tipuesearch.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Malaria Model  documentation" href="index.html"/>
        <link rel="up" title="Regression testing" href="dev-regression.html"/>
        <link rel="next" title="Create a new regression test" href="dev-regression-new.html"/>
        <link rel="prev" title="Regression testing" href="dev-regression.html"/>

<link href="https://fonts.googleapis.com/css?family=Lato|Montserrat|Open+Sans" rel="stylesheet">



  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Malaria Model
          

          
            
            <img src="_static/IDM_white.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                2.13
              </div>
            
          

          <div role="search">
  <form id='rtd-search-form' class='wy-form' action="search-local.html" method="get">
    <input type="text" name="q" id="tipue_search_input" autocomplete="off"
           placeholder="Search docs" required>
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Using the model</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="whats-new.html">What’s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-overview.html">EMOD installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro-overview.html">Introduction to the software</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro-modeling.html">Introduction to disease modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto-overview.html">How to use the software</a></li>
<li class="toctree-l1"><a class="reference internal" href="malaria-overview.html">Malaria disease overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="malaria-model-overview.html">Malaria model overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="malaria-IDM.html">Malaria research at IDM</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameter-overview.html">EMOD parameter reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="file-reference-overview.html">Input and output file structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting EMOD simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>
<p class="caption"><span class="caption-text">Advancing the model</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="dev-install-overview.html">EMOD source code installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-architecture-overview.html">EMOD architecture</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="dev-debugging-overview.html">Debugging and testing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="dev-logging.html">Set log levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev-simulations.html">Run debug simulations in Visual Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev-trouble-build.html">Troubleshooting EMOD builds</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="dev-regression.html">Regression testing</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Run regression tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev-regression-new.html">Create a new regression test</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Malaria Model</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
  <li><a href="../index.html">IDM docs</a> &raquo;</li>
    <li><a href="index.html">Malaria</a> &raquo;</li>
      
          <li><a href="dev-debugging-overview.html">Debugging and testing</a> &raquo;</li>
      
          <li><a href="dev-regression.html">Regression testing</a> &raquo;</li>
      
    <li>Run regression tests</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
<!-- From _templates/page.html -->

  <script>
     window.addEventListener("DOMContentLoaded", function() {
        var href = window.location.href;
        var oldBase = "https://institutefordiseasemodeling.github.io/EMOD/malaria/";
        var newBase = "https://www.idmod.org/docs/malaria/";
        var oldBasePattern = new RegExp(oldBase,"i");
        if (oldBasePattern.test(href)) {
           window.location.replace(href.replace(oldBasePattern,newBase));
        }
     }, true);
  </script>


  <div class="section" id="run-regression-tests">
<h1>Run regression tests<a class="headerlink" href="#run-regression-tests" title="Permalink to this headline">¶</a></h1>
<p>The Python script regression_test.py runs a suite of regression simulations and compares the output
to the reference output for each simulation. It is set up to run the simulations on an HPC cluster;
however, you can run modify the script to run tests locally. However, the script was written with
remote execution in mind and running it locally can be time-consuming. Running the entire regression
suite locally will take several hours on average.</p>
<p>The regression scenarios, script, configuration file, and other relevant files are all in the
<a class="reference external" href="https://github.com/InstituteforDiseaseModeling/EMOD/tree/master/Regression">Regression</a> directory. Be aware that many of these tests, due to abnormally high or low values, will
produce output that should not be considered scientifically accurate.</p>
<ol class="arabic">
<li><p class="first">Modify the configuration file, regression_test.cfg, for your environment, setting the values
for the location of the working directory, input data files, binary file, and cluster settings.</p>
<ul class="simple">
<li>For local Windows simulations, set the values under [WINDOWS].</li>
<li>For local CentOS on Azure simulations, set the values under [POSIX]. Note that CentOS on Azure simulations
are run locally by default and cannot be commissioned to an HPC cluster.</li>
<li>For simulations on IDM HPC clusters, no changes are necessary if your username and password
are cached locally.</li>
<li>For simulations on your own HPC cluster, create [HPC-&lt;cluster&gt;] and [ENVIRONMENT-&lt;cluster&gt;]
sections for your cluster that contain the same variables as shown for IDM HPC
clusters.</li>
</ul>
</li>
<li><p class="first">Select the suite of regression tests you want to run. This is indicated by a JSON file in the
following format:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;tests&quot;</span><span class="p">:</span> <span class="p">[{</span>
        <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;Relative path to test directory.&quot;</span>
    <span class="p">},</span> <span class="p">{</span>
        <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;Relative path to test directory.&quot;</span>
    <span class="p">}]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can use one of the JSON files in the Regression directory or create your own. The sanity.json
file is recommended for quickly testing a wide range of EMOD functionality.</p>
</li>
<li><p class="first">From the Regression directory, open a Command Prompt window and run the regression test script,
regression_test.py. It requires the name of the regression suite (without the .json extension)
and the relative path to Eradication.exe. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">regression_test</span><span class="o">.</span><span class="n">py</span> <span class="n">sanity</span> <span class="o">..</span>\<span class="n">Eradication</span>\<span class="n">x64</span>\<span class="n">Release</span>\<span class="n">Eradication</span><span class="o">.</span><span class="n">exe</span>
</pre></div>
</div>
<p>In addition, you may need to include the following optional arguments depending on your
testing environment or how Eradication.exe was built.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">--perf</span></code></td>
<td>False</td>
<td>Measure Eradication.exe performance.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">--hidegraphs</span></code></td>
<td>False</td>
<td>Suppress pop-up graphs in case of validation failures.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">--debug</span></code></td>
<td>False</td>
<td>Use the debug path for EMODules.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">--label</span></code></td>
<td>&#160;</td>
<td>Add a custom suffix for HPC job name.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">--config</span></code></td>
<td>regression_test.cfg</td>
<td>The regression test configuration file.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">--disable-schema-test</span></code></td>
<td>True</td>
<td>Include to suppress schema testing, which is on by default.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">--use-dlls</span></code></td>
<td>False</td>
<td>Use EMODules when running tests.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">--all-outputs</span></code></td>
<td>False</td>
<td>Use all output JSON files for validation, not just InsetChart.json.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">--dll-path</span></code></td>
<td>&#160;</td>
<td>The path to the root directory of the EMODules to use.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">--skip-emodule-check</span></code></td>
<td>False</td>
<td>Skip checking if EMODules on the cluster are up-to-date, which can be slow.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">--scons</span></code></td>
<td>False</td>
<td>Indicate that this is a SCons build so custom DLLs are found in the build/64/Release directory.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">--local</span></code></td>
<td>False</td>
<td>Run all simulations locally.</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">Review the output and examine any failures.</p>
<p>EMOD will output the standard error and logging files, StdErr.txt and StdOut.txt, produced from
any simulation (see <a class="reference internal" href="file-error-logging.html"><span class="doc">Error and logging files</span></a>). In addition, regression_test.py will output time.txt
under the regression test working directory and report_xxxx.xml under Regression/reports. The time
report contains the EMOD version and total run time of the simulation. The regression report is
in <a class="reference external" href="http://junit.org">JUnit</a> standard form and captures run information, including pass/fail/complete and time to complete.</p>
<p>If a simulation completes saying the run passed but the channel order was different than the
reference output, this is considered a pass. However, if any output completes but does not match
the reference output, this is considered a failure and a matplotlib chart of the output will
appear in a pop-up window. The chart will appear immediately after the simulation, before the
entire suite of regression tests completes. You can manipulate the output of the charts, such as
adjusting the scale of the plots, zooming or panning, and so forth, through the icons at the
bottom of the chart window.</p>
<img alt="_images/matplotlibPopupChart.png" src="_images/matplotlibPopupChart.png" />
</li>
</ol>
<p>If any of the regression tests fail and you have <em>not</em> made any changes to the EMOD source code,
email <a class="reference external" href="mailto:support&#37;&#52;&#48;idmod&#46;org">support<span>&#64;</span>idmod<span>&#46;</span>org</a>.</p>
</div>


<div id="tipue_search_content"></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dev-regression-new.html" class="btn btn-neutral float-right" title="Create a new regression test" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="dev-regression.html" class="btn btn-neutral" title="Regression testing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Intellectual Ventures Management, LLC (IVM). All rights reserved.

    </p>
  </div>
<p>EMOD is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode">Creative Commons Attribution-Noncommercial-ShareAlike 4.0 License</a>.</p>
<p>Send documentation feedback to <a href="mailto:feedback@idmod.org" target="_top">feedback@idmod.org</a>.</p>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch_content.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch_set.js"></script>
      <script type="text/javascript" src="_static/runsearch.js"></script>
      <script type="text/javascript" src="_static/tablecollapse.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
<!-- Google analytics for IDM docs -->
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-87656833-3', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>